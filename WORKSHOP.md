# Уъркшоп към семинара "Програмиране с Go"

Този документ съдържа инструкциите за уъркшопа и вашето участие в него.

# Камък-ножица-хартия

Проектът, с който ще си играем в уъркшопа е имплементация на добре познатата на всички игра
"Камък-ножица-хартия" като мрежова игра.

Играта има 2 основни компонента:

- Сървър, който управлява играта и ние сме написали.
- Клиент, който ще трябва да напишете вие и да играете помежду си, като се свържете към сървъра!

# Инструкции

Тук ще опишем всички необходими стъпки, за да напишете първия си Go код. Не се колебайте да
задавате въпроси или да посочвате неточности.

## Инсталиране на Go

За първоначланата Go следвайте инструкциите на официалния сайт на Go.

- За Windows Пробвайте MSI инсталатора: https://golang.org/doc/install#windows
- За UNIX-базирана ОС, използвайте пакетния си мениджър или метода описан тук: https://golang.org/doc/install#tarball

За да проверите инсталацията си, следвайте инструкциите тук:
https://golang.org/doc/install#testing

## Задача: клиент за играта

Вашата задача ще е да напишете клиент за сървъра, написан на Golang. За да направите това, ще вие е
нужно да знаете как да си говорите със сървъра.

### Инсталирайте кода на Камък-Ножица-Хартия сървъра

```
$ go get github.com/emou/go-presentation/gorps
```

Ако искате, можете да стартирате сървъра с:

### main.go

Нека създадем директория `gorpsclient` с един файл `main.go`, където ще напишем кода на клиента.

```
$ mkdir $GOPATH/src/github.com/emou/go-presentation/gorpsclient/
$ cd $GOPATH/src/github.com/emou/go-presentation/gorpsclient/
$ touch main.go
```

Да добавим първоначалния код за клиента.
Използваме пакета от стандартната библиотека [net](https://golang.org/pkg/net/), за да се свържем
към сървъра.

```
package main

import (
"fmt"
"net"
)

func main() {
  serverAddr := "localhost:9000"
  _, err := net.Dial("tcp", serverAddr)
  if err != nil {
    panic(fmt.Sprintf("Error connectinng to %s: %s", serverAddr, err))
  }
}
```

Да проверим, че се билдва и работи:
```
$ go run main.go
```

Би трябвало програмата да се паникьоса
```
panic: Error connectinng to localhost:9000: dial tcp 127.0.0.1:9000: getsockopt: connection refused
...
```


### Свързване към сървъра

В друг терминал, можете да пуснете сървър локално:

```
$ gorps
Listening on [::]:9000
```

Ако изпълните клиента отново

```
$ go run main.go
```

би трябвало да успеете да се свържете към сървъра:

```
Connected to localhost:9000!
```

# Протокол

Сървърът на играта използва TCP и борави със съобщения, разделени със символ за нов ред `\n`. Всяко съобщение има формата:

```
<MESSAGE>:param1:param2:...
```

Пример:

```
LOGIN:user:password
```

### Login

Първото съобщение, което сървърът изпраща, е LOGIN без параметри:

```
LOGIN
```

като след него очаква клиента да изпрати потребител и парола `LOGIN:user:password`.

Нека напишем кода в клиента:

```
```

TODO:

> "LOGIN:emo:1234"
< "MATCH_START:other_user"
> "PLAY:1"
< "RESULT:win"


## Бот

Следващата ви задача ще е да напишете бот, който играе камък-ножица-хартия вместо вас. Нямате
ограничение в броя на връзки, които да използвате с едно и също име.
